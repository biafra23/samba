
def imageName = "besu-samba-plugin:latest"
def containerName = "besu-samba-plugin"


task buildAndRunDockerContainer {
    group = "docker"
    description = "Builds the Docker image and runs the container"

    doLast {
        exec {
            commandLine "docker", "build", "-t", imageName, "."
        }
        exec {
            commandLine "docker", "rm", "-f", containerName
            ignoreExitValue true // Ignore errors if container doesn't exist
        }
        exec {
            commandLine "docker", "run", "-d", "--name", containerName, "-p", "8080:8080", imageName
        }
    }
}

task stopAndRemoveDockerContainer {
    group = "docker"
    description = "Stops and removes the running Docker container"

    doLast {
        exec {
            commandLine "docker", "stop", containerName
            ignoreExitValue true
        }
        exec {
            commandLine "docker", "rm", containerName
            ignoreExitValue true
        }
    }
}
